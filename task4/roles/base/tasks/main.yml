- name: Gathering fact
  setup:
    gather_subset: all

- name: Create fact directory
  become: yes
  file:
    path: /etc/ansible/facts.d/
    state: directory
    mode: 0755

- name: Install Custom Facts
  become: yes
  copy:
    src: custom.fact
    dest: /etc/ansible/facts.d/
    mode: 0644

- name: Install package
  become: yes
  apt: name={{ pkgs }} state=latest
  when: ansible_os_family == "Debian"

- name: Install package
  become: yes
  yum: name={{ pkgs }} state=latest
  when: ansible_os_family == "RedHat"

- name: Disable requiretty in sudo
  become: yes
  lineinfile:
    dest: /etc/sudoers
    line: 'Defaults requiretty'
    state: absent